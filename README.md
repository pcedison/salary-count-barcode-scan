# 薪資計算系統

## 專案概述
這是一個專為中小型企業設計的薪資計算網絡應用程序，提供完整的考勤追蹤、加班計算和薪資報告功能。系統採用兩層存儲架構，支持臨時數據與永久數據記錄，確保數據在各設備間持久性保存，並允許詳細的歷史記錄編輯。

## 主要功能
- **考勤記錄**：靈活記錄員工上下班時間，支持精確時間輸入
- **加班計算**：根據兩階段加班倍率（1.34x和1.67x）自動計算加班費
- **假日工作**：支持假日工作的額外薪資計算和假日設置管理
- **薪資報表**：生成詳細的月度薪資報表，支持打印和CSV匯出
- **歷史記錄**：保存和查看過去的薪資記錄，支持恢復編輯功能
- **設置管理**：自定義基本工資、加班費率、福利和扣除項目
- **管理員功能**：通過PIN碼認證的管理員權限控制
- **數據持久化**：使用Supabase確保跨設備數據一致性

## 薪資計算邏輯
- **基本月薪**：默認為28,590元
- **基本時薪**：119元（計算方式：月薪÷30天÷8小時）
- **加班費率**：
  - 第一階段（16:00-18:00）：1.34倍基本時薪
  - 第二階段（18:00以後）：1.67倍基本時薪
- **加班計算規則**：
  - 最小加班單位為0.5小時
  - 第一階段加班最多計算2小時
  - 第二階段加班沒有上限
  - 加班計算採用四捨五入到最接近的0.5小時
  - 下班時間超過16:00後有7分鐘緩衝時間不計入加班
- **假日薪資**：基本月薪÷30（四捨五入到整數）×假日天數
- **總薪資計算**：月薪+加班費+假日薪資+福利津貼-扣除項目

## 技術棧
- **前端**：React, TypeScript, Tailwind CSS, Shadcn UI
- **後端**：Node.js, Express
- **數據庫**：PostgreSQL, Drizzle ORM
- **雲存儲**：Supabase（或本地PostgreSQL）
- **狀態管理**：React Query
- **身份驗證**：自定義PIN碼認證

## 安裝與部署
詳細的安裝和部署步驟請參閱 [DEPLOYMENT.md](./DEPLOYMENT.md)。

### 快速開始
1. 克隆此存儲庫
   ```bash
   git clone https://github.com/pcedison/Salary-counting.git
   cd Salary-counting
   ```

2. 安裝所有依賴
   ```bash
   npm install
   ```

3. 設置環境變數（創建.env文件）
   ```
   DATABASE_URL=postgres://username:password@host:5432/database
   SESSION_SECRET=your_secure_session_secret
   ```

4. 初始化數據庫
   ```bash
   node setup-db.js
   ```

5. 啟動應用程序
   ```bash
   npm run dev
   ```

6. 訪問 `http://localhost:3000` 開始使用

## 系統要求
- Node.js 18+
- PostgreSQL 15+（或Supabase帳戶）
- 現代網絡瀏覽器（Chrome, Firefox, Safari）

## 管理員訪問
- 默認管理員PIN：`123456`
- 管理員可以訪問和修改系統設置、歷史記錄等敏感功能
- 建議初次使用後立即更改默認PIN碼
- PIN碼修改位於設置頁面的管理員區域

## 常見問題
1. **數據無法保存？** - 確認數據庫連接字符串正確，且數據庫服務運行中
2. **加班計算不準確？** - 檢查設置頁面的加班倍率設置
3. **打印頁面不完整？** - 使用Chrome瀏覽器獲得最佳打印效果

## 開發者指南
如需貢獻代碼或自定義系統，請參考以下核心文件：
- 前端組件：`/client/src/components/`
- 數據模型：`/shared/schema.ts`
- API路由：`/server/routes.ts`
- 數據庫邏輯：`/server/storage.ts`
